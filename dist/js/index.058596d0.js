(function(){"use strict";var e={4119:function(e,t,n){var o=n(5130),i=(n(8077),n(4114),n(6768)),r=n(4232),a=n(144),c=n(6982);n(9076),n(434);const u={id:"app"};var l={__name:"App",setup(e){const t=(0,a.KR)([]),n=(0,a.KR)([]);var o=[];async function l(e){await Word.run((async e=>{const t=e.document.getSelection();t.load(["text","fields","parentBody","isEmpty"]),await e.sync();const r=e.document.getSelection().paragraphs.getFirst(),a=t.expandToOrNullObject(r.getRange(Word.RangeLocation.end));a.load(["text","fields","parentBody","isEmpty"]),await e.sync();const c=a.fields;if(c.load(["items"]),await e.sync(),c.items.length>0){const t=c.items[0];if(t.load(["code","result","locked","type","data","kind"]),await e.sync(),"Addin"==t.type&&t.code.includes("ZOTERO_ITEM")){console.log("Range of result: "+t.result["text"]);var u=t.result["text"],l=a.text.indexOf(u);if(-1==l||l>5)return;var f=o.indexOf(u);if(-1==f)return;await(0,i.dY)(),n.value[f].scrollIntoView({block:"center",behavior:"smooth"})}}}))}async function f(){await Word.run((async e=>{const n=e.document.body.fields;n.load(["items"]),await e.sync(),t.value=[],o=[];for(let y=0;y<n.items.length;y++){const v=n.items[y];v.load(["code","result","locked","type","data","kind"]),await e.sync();var i={citation:"",bibliography:""};if("Addin"==v.type&&v.code.includes("ZOTERO_ITEM")){var r=v.code.replace("ADDIN ZOTERO_ITEM CSL_CITATION ","").trim(),a=JSON.parse(r);console.log("Range of result "+y+": "+v.result["text"]),i["citation"]=a["properties"]["plainCitation"],o.push(a["properties"]["plainCitation"]);var u=a["citationItems"],l=[];for(let e=0;e<u.length;e++){var f=u[e],s=f["itemData"],d=new c.I8(s),p=d.format("bibliography",{format:"text",template:"apa"});l.push(p)}i["bibliography"]=l,t.value.push(i)}}}))}return(0,i.sV)((async()=>{Office.context.document.addHandlerAsync(Office.EventType.DocumentSelectionChanged,l)})),(0,i.hi)((()=>{Office.context.document.removeHandlerAsync(Office.EventType.DocumentSelectionChanged,l)})),(e,o)=>((0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("button",{class:"btn btn-primary btn-run",onClick:f},"运行"),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.value,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:"ctn-panel",ref_for:!0,ref_key:"ctnViews",ref:n},[(0,i.Lk)("h3",null,(0,r.v_)(e["citation"]),1),(0,i.Lk)("ul",null,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e["bibliography"],((e,t)=>((0,i.uX)(),(0,i.CE)("li",{key:t},(0,r.v_)(e),1)))),128))])])))),128))]))}};const f=l;var s=f;window.__VUE_PROD_DEVTOOLS__=!1,window.__VUE_PROD_HYDRATION_MISMATCH_DETAILS__=!1,Office.onReady((e=>{const t=(0,o.Ef)(s);t.provide("office",e.host),t.mount("#app")}))}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,r){if(!o){var a=1/0;for(f=0;f<e.length;f++){o=e[f][0],i=e[f][1],r=e[f][2];for(var c=!0,u=0;u<o.length;u++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[u])}))?o.splice(u--,1):(c=!1,r<a&&(a=r));if(c){e.splice(f--,1);var l=i();void 0!==l&&(t=l)}}return t}r=r||0;for(var f=e.length;f>0&&e[f-1][2]>r;f--)e[f]=e[f-1];e[f]=[o,i,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={57:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,r,a=o[0],c=o[1],u=o[2],l=0;if(a.some((function(t){return 0!==e[t]}))){for(i in c)n.o(c,i)&&(n.m[i]=c[i]);if(u)var f=u(n)}for(t&&t(o);l<a.length;l++)r=a[l],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(f)},o=self["webpackChunkoffice_zotero_vue"]=self["webpackChunkoffice_zotero_vue"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(4119)}));o=n.O(o)})();
//# sourceMappingURL=index.058596d0.js.map